import{ay as O,e as U,az as P,aa as R,a9 as F}from"./StaticSceneBVH-Cy08W0XA.js";const v=new U;function z(i,o,r,u,l,s){const e=2*Math.PI*l/4,f=Math.max(s-2*l,0),m=Math.PI/4;v.copy(o),v[u]=0,v.normalize();const t=.5*e/(e+f),y=1-v.angleTo(i)/m;return Math.sign(v[r])===1?y*t:f/(e+f)+t+t*(1-y)}class B extends O{constructor(o=1,r=1,u=1,l=2,s=.1){const e=l*2+1;if(s=Math.min(o/2,r/2,u/2,s),super(1,1,1,e,e,e),this.type="RoundedBoxGeometry",this.parameters={width:o,height:r,depth:u,segments:l,radius:s},e===1)return;const f=this.toNonIndexed();this.index=null,this.attributes.position=f.attributes.position,this.attributes.normal=f.attributes.normal,this.attributes.uv=f.attributes.uv;const m=new U,t=new U,y=new U(o,r,u).divideScalar(2).subScalar(s),M=this.attributes.position.array,A=this.attributes.normal.array,g=this.attributes.uv.array,E=M.length/6,c=new U,I=.5/e;for(let b=0,n=0;b<M.length;b+=3,n+=2)switch(m.fromArray(M,b),t.copy(m),t.x-=Math.sign(t.x)*I,t.y-=Math.sign(t.y)*I,t.z-=Math.sign(t.z)*I,t.normalize(),M[b+0]=y.x*Math.sign(m.x)+t.x*s,M[b+1]=y.y*Math.sign(m.y)+t.y*s,M[b+2]=y.z*Math.sign(m.z)+t.z*s,A[b+0]=t.x,A[b+1]=t.y,A[b+2]=t.z,Math.floor(b/E)){case 0:c.set(1,0,0),g[n+0]=z(c,t,"z","y",s,u),g[n+1]=1-z(c,t,"y","z",s,r);break;case 1:c.set(-1,0,0),g[n+0]=1-z(c,t,"z","y",s,u),g[n+1]=1-z(c,t,"y","z",s,r);break;case 2:c.set(0,1,0),g[n+0]=1-z(c,t,"x","z",s,o),g[n+1]=z(c,t,"z","x",s,u);break;case 3:c.set(0,-1,0),g[n+0]=1-z(c,t,"x","z",s,o),g[n+1]=1-z(c,t,"z","x",s,u);break;case 4:c.set(0,0,1),g[n+0]=1-z(c,t,"x","y",s,o),g[n+1]=1-z(c,t,"y","x",s,r);break;case 5:c.set(0,0,-1),g[n+0]=z(c,t,"x","y",s,o),g[n+1]=1-z(c,t,"y","x",s,r);break}}static fromJSON(o){return new B(o.width,o.height,o.depth,o.segments,o.radius)}}function V(i,o=1e-4){o=Math.max(o,Number.EPSILON);const r={},u=i.getIndex(),l=i.getAttribute("position"),s=u?u.count:l.count;let e=0;const f=Object.keys(i.attributes),m={},t={},y=[],M=["getX","getY","getZ","getW"],A=["setX","setY","setZ","setW"];for(let n=0,x=f.length;n<x;n++){const h=f[n],a=i.attributes[h];m[h]=new a.constructor(new a.array.constructor(a.count*a.itemSize),a.itemSize,a.normalized);const T=i.morphAttributes[h];T&&(t[h]||(t[h]=[]),T.forEach((p,w)=>{const S=new p.array.constructor(p.count*p.itemSize);t[h][w]=new p.constructor(S,p.itemSize,p.normalized)}))}const g=o*.5,E=Math.log10(1/o),c=Math.pow(10,E),I=g*c;for(let n=0;n<s;n++){const x=u?u.getX(n):n;let h="";for(let a=0,T=f.length;a<T;a++){const p=f[a],w=i.getAttribute(p),S=w.itemSize;for(let X=0;X<S;X++)h+=`${~~(w[M[X]](x)*c+I)},`}if(h in r)y.push(r[h]);else{for(let a=0,T=f.length;a<T;a++){const p=f[a],w=i.getAttribute(p),S=i.morphAttributes[p],X=w.itemSize,N=m[p],j=t[p];for(let d=0;d<X;d++){const D=M[d],G=A[d];if(N[G](e,w[D](x)),S)for(let k=0,H=S.length;k<H;k++)j[k][G](e,S[k][D](x))}}r[h]=e,y.push(e),e++}}const b=i.clone();for(const n in i.attributes){const x=m[n];if(b.setAttribute(n,new x.constructor(x.array.slice(0,e*x.itemSize),x.itemSize,x.normalized)),n in t)for(let h=0;h<t[n].length;h++){const a=t[n][h];b.morphAttributes[n][h]=new a.constructor(a.array.slice(0,e*a.itemSize),a.itemSize,a.normalized)}}return b.setIndex(y),b}function W(i,o){if(o===P)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(o===R||o===F){let r=i.getIndex();if(r===null){const e=[],f=i.getAttribute("position");if(f!==void 0){for(let m=0;m<f.count;m++)e.push(m);i.setIndex(e),r=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}const u=r.count-2,l=[];if(o===R)for(let e=1;e<=u;e++)l.push(r.getX(0)),l.push(r.getX(e)),l.push(r.getX(e+1));else for(let e=0;e<u;e++)e%2===0?(l.push(r.getX(e)),l.push(r.getX(e+1)),l.push(r.getX(e+2))):(l.push(r.getX(e+2)),l.push(r.getX(e+1)),l.push(r.getX(e)));l.length/3!==u&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=i.clone();return s.setIndex(l),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",o),i}export{B as R,V as m,W as t};
//# sourceMappingURL=BufferGeometryUtils-CLnqpj6S.js.map
